(function(){(function(n){return typeof define=="function"&&define.amd?define(["jquery"],n):n(window.jQuery)})(function(n){"use strict";var f,e,s,o,u,t,r,i,h;return h="caret",f=function(){function u(n){this.$inputor=n;this.domInputor=this.$inputor[0]}return u.prototype.setPos=function(){return this.domInputor},u.prototype.getIEPosition=function(){return n.noop()},u.prototype.getPosition=function(){return n.noop()},u.prototype.getOldIEPos=function(){var n,i;return i=t.selection.createRange(),n=t.body.createTextRange(),n.moveToElementText(this.domInputor),n.setEndPoint("EndToEnd",i),n.text.length},u.prototype.getPos=function(){var n,r,i;return(i=this.range())?(n=i.cloneRange(),n.selectNodeContents(this.domInputor),n.setEnd(i.endContainer,i.endOffset),r=n.toString().length,n.detach(),r):t.selection?this.getOldIEPos():void 0},u.prototype.getOldIEOffset=function(){var i,n;return i=t.selection.createRange().duplicate(),i.moveStart("character",-1),n=i.getBoundingClientRect(),{height:n.bottom-n.top,left:n.left,top:n.top}},u.prototype.getOffset=function(){var e,f,u,o;if(i.getSelection&&(u=this.range())){if(u.endOffset-1<0)return null;e=u.cloneRange();e.setStart(u.endContainer,u.endOffset-1);e.setEnd(u.endContainer,u.endOffset);o=e.getBoundingClientRect();f={height:o.height,left:o.left+o.width,top:o.top};e.detach()}else t.selection&&(f=this.getOldIEOffset());return f&&!r&&(f.top+=n(i).scrollTop(),f.left+=n(i).scrollLeft()),f},u.prototype.range=function(){var n;if(i.getSelection)return n=i.getSelection(),n.rangeCount>0?n.getRangeAt(0):null},u}(),e=function(){function r(n){this.$inputor=n;this.domInputor=this.$inputor[0]}return r.prototype.getIEPos=function(){var u,n,f,o,e,i,r;return n=this.domInputor,i=t.selection.createRange(),e=0,i&&i.parentElement()===n&&(o=n.value.replace(/\r\n/g,"\n"),f=o.length,r=n.createTextRange(),r.moveToBookmark(i.getBookmark()),u=n.createTextRange(),u.collapse(!1),e=r.compareEndPoints("StartToEnd",u)>-1?f:-r.moveStart("character",-f)),e},r.prototype.getPos=function(){return t.selection?this.getIEPos():this.domInputor.selectionStart},r.prototype.setPos=function(n){var i,r;return i=this.domInputor,t.selection?(r=i.createTextRange(),r.move("character",n),r.select()):i.setSelectionRange&&i.setSelectionRange(n,n),i},r.prototype.getIEOffset=function(n){var i,t,r,u;return t=this.domInputor.createTextRange(),n||(n=this.getPos()),t.move("character",n),r=t.boundingLeft,u=t.boundingTop,i=t.boundingHeight,{left:r,top:u,height:i}},r.prototype.getOffset=function(r){var f,u,e;return f=this.$inputor,t.selection?(u=this.getIEOffset(r),u.top+=n(i).scrollTop()+f.scrollTop(),u.left+=n(i).scrollLeft()+f.scrollLeft(),u):(u=f.offset(),e=this.getPosition(r),{left:u.left+e.left-f.scrollLeft(),top:u.top+e.top-f.scrollTop(),height:e.height})},r.prototype.getPosition=function(n){var t,r,i,u,f;return t=this.$inputor,r=function(n){return n.replace(/</g,"&lt").replace(/>/g,"&gt").replace(/`/g,"&#96").replace(/"/g,"&quot").replace(/\r\n|\r|\n/g,"<br />")},n===void 0&&(n=this.getPos()),f=t.val().slice(0,n),i="<span>"+r(f)+"<\/span>",i+="<span id='caret'>|<\/span>",u=new s(t),u.create(i).rect()},r.prototype.getIEPosition=function(n){var r,i,t,u,f;return t=this.getIEOffset(n),i=this.$inputor.offset(),u=t.left-i.left,f=t.top-i.top,r=t.height,{left:u,top:f,height:r}},r}(),s=function(){function t(n){this.$inputor=n}return t.prototype.css_attr=["overflowY","height","width","paddingTop","paddingLeft","paddingRight","paddingBottom","marginTop","marginLeft","marginRight","marginBottom","fontFamily","borderStyle","borderWidth","wordWrap","fontSize","lineHeight","overflowX","text-align"],t.prototype.mirrorCss=function(){var t,i=this;return t={position:"absolute",left:-9999,top:0,zIndex:-2e4,"white-space":"pre-wrap"},n.each(this.css_attr,function(n,r){return t[r]=i.$inputor.css(r)}),t},t.prototype.create=function(t){return this.$mirror=n("<div><\/div>"),this.$mirror.css(this.mirrorCss()),this.$mirror.html(t),this.$inputor.after(this.$mirror),this},t.prototype.rect=function(){var n,t,i;return n=this.$mirror.find("#caret"),t=n.position(),i={left:t.left,top:t.top,height:n.height()},this.$mirror.remove(),i},t}(),o={contentEditable:function(n){return!!(n[0].contentEditable&&n[0].contentEditable==="true")}},u={pos:function(n){return n?this.setPos(n):this.getPos()},position:function(n){return t.selection?this.getIEPosition(n):this.getPosition(n)},offset:function(t){var u,i;return i=this.getOffset(t),r&&(u=n(r).offset(),i.top+=u.top,i.left+=u.left),i}},t=null,i=null,r=null,n.fn.caret=function(s){var h;return t=this[0].ownerDocument,i=t.defaultView||t.parentWindow,r=i.frameElement,h=o.contentEditable(this)?new f(this):new e(this),u[s]?u[s].apply(h,Array.prototype.slice.call(arguments,1)):n.error("Method "+s+" does not exist on jQuery.caret")},n.fn.caret.EditableCaret=f,n.fn.caret.InputCaret=e,n.fn.caret.Utils=o,n.fn.caret.apis=u})}).call(this);
